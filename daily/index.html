<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>今日の記録</title>
  <style>
    body{font-family:system-ui, sans-serif; max-width:720px; margin:24px auto; padding:0 12px;}
    label{display:block; margin:12px 0 6px;}
    input, textarea{width:100%; padding:10px; font-size:16px;}
    button{padding:10px 16px; font-size:16px; margin-top:12px;}
    pre{background:#f6f6f6; padding:12px; overflow:auto;}
  </style>
</head>
<body>
  <h1>今日の記録</h1>

  <label>ユーザーID（任意）</label>
  <input id="userId" placeholder="例）LINEのuserIdやニックネーム" />

  <label>今日の記録（必須）</label>
  <textarea id="text" rows="6" placeholder="例）朝：卵・味噌汁、体調：むくみ など"></textarea>

  <button id="sendBtn">送信</button>

  <h2>結果</h2>
  <pre id="result">(まだ送信していません)</pre>

  <script>
    const resultEl = document.getElementById("result");
    document.getElementById("sendBtn").addEventListener("click", async () => {
      resultEl.textContent = "送信中...";
      const userId = document.getElementById("userId").value;
      const text = document.getElementById("text").value;

      try {
        const res = await fetch("/.netlify/functions/daily-submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ userId, text })
        });
        const data = await res.json().catch(() => ({}));
        resultEl.textContent = JSON.stringify({ status: res.status, data }, null, 2);
      } catch (e) {
        resultEl.textContent = "エラー: " + e.message;
      }
    });
  </script>
</body>
</html>
